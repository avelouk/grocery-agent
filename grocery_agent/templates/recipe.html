{% extends "base.html" %}
{% block title %}{{ recipe.name }} – Grocery Agent{% endblock %}
{% block content %}
  <nav class="nav"><a href="/">← Recipes</a></nav>
  {% if recipe.image_url %}
  <p style="margin: 0 0 0.75rem 0;"><img src="{{ recipe.image_url }}" alt="" style="max-width: 100%; height: auto; border: var(--pixel) solid var(--border); border-radius: var(--radius);" loading="lazy" referrerpolicy="no-referrer"></p>
  {% endif %}
  <h1>{{ recipe.name }}</h1>
  {% if recipe.source_url %}
  <p class="muted"><a href="{{ recipe.source_url }}" target="_blank" rel="noopener">Source</a></p>
  {% endif %}

  <div class="card" style="display: inline-flex; flex-wrap: wrap; align-items: center; gap: 0.75rem;">
    <form method="get" action="/recipe/{{ recipe_id }}" style="display: flex; align-items: center; gap: 0.5rem; margin: 0;">
      <label for="servings" style="margin: 0;">Servings</label>
      <input type="number" id="servings" name="servings" value="{{ servings }}" min="1" max="99" class="input-count" style="margin: 0;">
      <button type="submit">Update</button>
    </form>
  </div>

  <h2>Ingredients</h2>
  <p class="muted">Pantry = have at home. Weekly = to buy.</p>
  <ul class="pixel-list">
    {% for ing in ingredients_display %}
    <li>
      {{ ing.amount_str }} {{ ing.name }}{% if ing.optional %} <span class="muted" style="font-style: italic;">(optional)</span>{% endif %}
      <span class="muted" style="font-size: 0.95rem;"> · {{ ing.category.value }} · {% if ing.pantry_item %}pantry{% else %}weekly{% endif %}</span>
    </li>
    {% endfor %}
  </ul>

  <h2>Instructions</h2>
  <div class="card">
    <pre style="white-space: pre-wrap; font-family: inherit; margin: 0; line-height: 1.6;">{{ recipe.instructions }}</pre>
  </div>
  <p><a href="/">← Back to recipes</a></p>
{% endblock %}
