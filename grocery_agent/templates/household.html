{% extends "base.html" %}
{% block title %}Household items – Grocery Agent{% endblock %}
{% block head %}
  <style>
    .household-list { list-style: none; padding: 0; margin: 0; }
    .household-item {
      display: flex;
      align-items: center;
      gap: 0.85rem;
      flex-wrap: wrap;
      padding: 0.6rem 0.9rem;
      margin-bottom: 0.4rem;
      background: var(--surface);
      border: var(--pixel) solid var(--border);
      border-radius: var(--radius);
      box-shadow: 2px 2px 0 var(--border);
      font-size: 1.1rem;
      line-height: 1.4;
      border-left-width: 5px;
      min-height: 2.75rem;
    }
    .household-item-urgency-green { border-left-color: #059669; }
    .household-item-urgency-yellow { border-left-color: #ca8a04; }
    .household-item-urgency-red { border-left-color: #dc2626; }
    .household-item input[type=checkbox] { width: 1.15rem; height: 1.15rem; cursor: pointer; }
    .household-item label { margin: 0; font-size: 1.1rem; font-weight: 500; cursor: pointer; flex: 1; min-width: 0; }
    .household-meta { font-size: 1rem; color: var(--muted); }
    .household-badge { font-size: 0.9rem; padding: 0.2rem 0.55rem; border-radius: var(--radius); background: #fef2f2; color: #dc2626; font-weight: 500; }
    .household-legend { display: flex; gap: 1rem; flex-wrap: wrap; margin-bottom: 0.75rem; font-size: 0.9rem; color: var(--muted); }
    .household-legend span { display: inline-flex; align-items: center; gap: 0.35rem; }
  </style>
{% endblock %}
{% block content %}
  <nav class="nav"><a href="/">Home</a> · <a href="/list/checklist?ids={{ recipe_ids_str }}">Checklist</a> · <strong style="color: var(--text);">Household</strong></nav>
  <h1>Household items</h1>
  <p class="muted" style="margin-bottom: 0.5rem;">Check items you need to replenish. All unchecked by default.</p>
  <p class="muted" style="margin-bottom: 1rem;">Color shows time since last purchase: <span style="color: #059669;">■</span> recent · <span style="color: #ca8a04;">■</span> getting low · <span style="color: #dc2626;">■</span> likely running out. Items at the top are most likely to need replenishing.</p>

  <form method="post" action="/list/confirm" id="household-form">
    <button type="button" style="margin-bottom: 0.75rem; font-size: 0.9rem; background: var(--bg); color: var(--text);" onclick="document.querySelectorAll('.household-item-urgency-red input[type=checkbox]').forEach(c => c.checked = true)">Select all running low</button>
    <ul class="household-list">
      {% for item in household_items %}
      <li class="household-item household-item-urgency-{{ item.urgency_class }}">
        <input type="checkbox" name="household_item_id" value="{{ item.id }}" id="hh_{{ item.id }}">
        <label for="hh_{{ item.id }}">
          {{ item.name }}
          <span class="household-meta">— Last bought {{ item.days_since_purchase }} day{{ 's' if item.days_since_purchase != 1 else '' }} ago · typical {{ item.typical_duration_days }} days</span>
          {% if item.running_low %}<span class="household-badge">Likely running low</span>{% endif %}
        </label>
      </li>
      {% endfor %}
    </ul>
    <button type="submit" style="margin-top: 0.75rem;">Confirm and add to cart</button>
  </form>
  <p style="margin-top: 1.25rem;"><a href="/list/checklist?ids={{ recipe_ids_str }}">Back to checklist</a> · <a href="/">Change recipes</a></p>
{% endblock %}
