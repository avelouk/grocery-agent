{% extends "base.html" %}
{% block title %}Grocery list – Grocery Agent{% endblock %}
{% block content %}
  <nav class="nav"><a href="/">Home</a> · <strong style="color: var(--text);">Checklist</strong></nav>
  <h1>Your grocery list</h1>
  <p class="muted">{% for r in recipes %}{{ r.name }} ({{ r.portions | int }} portions){% if not loop.last %}; {% endif %}{% endfor %}</p>
  <p class="muted" style="margin-bottom: 1rem;">Check items to order. Pantry items start unchecked.</p>

  <form method="post" action="/list/confirm">
    <input type="hidden" name="recipe_ids" value="{{ recipe_ids | join(',') }}">
    {% for rid, portion in recipe_portions %}
    <input type="hidden" name="portion_{{ rid }}" value="{{ portion }}">
    {% endfor %}
    <ul style="list-style: none; padding: 0;">
      {% for ing in ingredients_display %}
      <li class="card" style="display: flex; align-items: center; gap: 0.75rem; flex-wrap: wrap;">
        <input type="checkbox" name="item_index" value="{{ ing.index }}" id="item_{{ ing.index }}" {{ 'checked' if not ing.pantry_item else '' }}>
        <label for="item_{{ ing.index }}" style="margin: 0; min-width: 5.5rem;" class="muted amount-label">{{ ing.amount_str }}</label>
        <span style="flex: 1; min-width: 0;">{{ ing.name }}{% if ing.optional %} <span class="muted" style="font-style: italic;">(optional)</span>{% endif %}</span>
        <span class="muted" style="font-size: 0.95rem;">{{ ing.category }} · {% if ing.pantry_item %}pantry{% else %}weekly{% endif %}</span>
      </li>
      {% endfor %}
    </ul>
    <button type="submit" style="margin-top: 0.5rem;">Confirm and add to cart</button>
  </form>
  <p style="margin-top: 1.25rem;"><a href="/">Change recipes</a></p>
{% endblock %}
