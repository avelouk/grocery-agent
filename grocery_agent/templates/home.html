{% extends "base.html" %}
{% block title %}Grocery Agent{% endblock %}
{% block content %}
  <header style="margin-bottom: 1.75rem;">
    <h1>Grocery Agent</h1>
    <p class="muted">Pick recipes for the week, then build your list.</p>
  </header>

  {% if error %}
  <div class="alert alert-error" role="alert">{{ error }}</div>
  {% endif %}

  {% if recipes %}
  <div class="card">
    <form method="post" action="/list">
      <div style="display: flex; flex-wrap: wrap; align-items: center; justify-content: space-between; gap: 0.75rem; margin-bottom: 1rem;">
        <strong>This week</strong>
        <button type="submit">Generate grocery list</button>
      </div>
      <ul class="recipe-list">
        {% for r in recipes %}
        <li>
          <label style="margin: 0; flex: 1; min-width: 0;">
            <input type="checkbox" name="recipe_ids" value="{{ r.id }}" {{ 'checked' if new_id and r.id == new_id else '' }}>
            {{ r.name }}
          </label>
          <span class="muted" style="font-size: 0.95rem;">Portions</span>
          <input type="number" name="portion_{{ r.id }}" value="{{ r.portions | int }}" min="1" max="99" class="input-count">
          <a href="/recipe/{{ r.id }}/edit" style="font-size: 0.9rem;">Edit</a>
        </li>
        {% endfor %}
      </ul>
    </form>
  </div>
  {% else %}
  <div class="card">
    <p style="margin: 0;"><strong>No recipes yet.</strong> Add one below (link or paste).</p>
  </div>
  {% endif %}

  <div class="card">
    <h2 style="margin-top: 0;">Add a recipe</h2>
    <form method="post" action="/ingest">
      <label for="url">Recipe URL (optional)</label>
      <input type="url" id="url" name="url" placeholder="https://...">
      <label for="text">Or paste recipe text</label>
      <textarea id="text" name="text" placeholder="Paste recipe here..." style="min-height: 100px; resize: vertical;"></textarea>
      <button type="submit">Add recipe</button>
    </form>
  </div>
{% endblock %}
